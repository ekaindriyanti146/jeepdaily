{{ define "main" }}
<div class="container mx-auto px-4 py-12">

    <!-- HEADER KATEGORI (Jeep Style) -->
    <header class="mb-12 border-b-4 border-gray-900 pb-6">
        <span class="text-red-600 font-bold tracking-widest uppercase text-xs mb-2 block">
            Category Archive
        </span>
        <h1 class="font-display font-black text-4xl md:text-6xl text-gray-900 uppercase tracking-tighter">
            {{ .Title }}
        </h1>
        {{ if .Description }}
        <p class="text-gray-500 mt-2 text-lg max-w-2xl">
            {{ .Description }}
        </p>
        {{ end }}
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
        
        <!-- KOLOM ARTIKEL (Kiri) -->
        <div class="lg:col-span-8 flex flex-col gap-10">
            
            <!-- Loop Artikel -->
            {{ range $index, $element := .Paginator.Pages }}
            <article class="flex flex-col md:flex-row gap-6 group">
                
                <!-- Thumbnail Image -->
                <a href="{{ .Permalink }}" class="shrink-0 w-full md:w-64 h-48 overflow-hidden rounded-sm bg-gray-200 relative">
                    {{ if .Params.featured_image }}
                    <img src="{{ .Params.featured_image }}" alt="{{ .Title }}" class="w-full h-full object-cover transition duration-500 group-hover:scale-110 group-hover:sepia-[.5]">
                    {{ else }}
                    <div class="w-full h-full flex items-center justify-center text-gray-400 bg-gray-800">
                        <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                    </div>
                    {{ end }}
                </a>

                <!-- Content Preview -->
                <div class="flex flex-col justify-center">
                    <div class="flex items-center gap-2 mb-2">
                        {{ if .Params.categories }}
                        <span class="text-[10px] font-bold text-red-600 uppercase tracking-widest">
                            {{ index .Params.categories 0 }}
                        </span>
                        {{ end }}
                        <span class="text-[10px] text-gray-400 uppercase">| {{ .Date.Format "Jan 02, 2006" }}</span>
                    </div>

                    <h2 class="font-display font-bold text-2xl leading-tight mb-3 group-hover:text-red-600 transition">
                        <a href="{{ .Permalink }}">
                            {{ .Title }}
                        </a>
                    </h2>
                    
                    <p class="text-gray-600 text-sm line-clamp-2 leading-relaxed mb-4">
                        {{ .Summary | plainify | truncate 150 }}
                    </p>

                    <a href="{{ .Permalink }}" class="inline-flex items-center text-xs font-black uppercase text-gray-900 border-b-2 border-red-600 pb-0.5 hover:text-red-600 transition">
                        Read Full Story 
                        <svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </a>
                </div>
            </article>

            <!-- LOGIC IKLAN IN-FEED (Muncul setiap 3 artikel) -->
            <!-- Ini aman dari error 'context' karena dipisah div-nya -->
            {{ if eq (mod $index 3) 2 }}
            <div class="w-full bg-gray-50 border border-gray-100 p-4 flex justify-center items-center min-h-[120px]">
                 <!-- PASANG KODE IKLAN IN-FEED DISINI -->
                 <span class="text-xs text-gray-300 uppercase tracking-widest">Sponsored / Ad Space</span>
            </div>
            {{ end }}

            {{ end }}

            <!-- PAGINATION (Tombol Next/Prev) -->
            {{ if gt .Paginator.TotalPages 1 }}
            <div class="flex justify-center mt-8 gap-2">
                {{ if .Paginator.HasPrev }}
                <a href="{{ .Paginator.Prev.URL }}" class="px-4 py-2 bg-gray-900 text-white text-xs font-bold uppercase rounded hover:bg-red-600 transition">← Previous</a>
                {{ end }}
                
                <span class="px-4 py-2 text-xs font-bold text-gray-500 uppercase">
                    Page {{ .Paginator.PageNumber }} of {{ .Paginator.TotalPages }}
                </span>

                {{ if .Paginator.HasNext }}
                <a href="{{ .Paginator.Next.URL }}" class="px-4 py-2 bg-gray-900 text-white text-xs font-bold uppercase rounded hover:bg-red-600 transition">Next →</a>
                {{ end }}
            </div>
            {{ end }}

        </div>

        <!-- SIDEBAR (Kanan) -->
        <aside class="lg:col-span-4 hidden lg:block">
            <div class="sticky top-24">
                
                <!-- Kotak Iklan Sidebar -->
                <div class="bg-gray-50 border border-gray-200 min-h-[300px] flex items-center justify-center mb-10">
                    <span class="text-xs text-gray-400 uppercase tracking-widest">Sidebar Ad</span>
                </div>

                <!-- Trending Topics / Categories -->
                <div class="mb-10">
                    <h3 class="font-display font-bold text-lg uppercase border-b-2 border-red-600 pb-2 mb-4">
                        Garage Topics
                    </h3>
                    <div class="flex flex-col gap-2">
                        {{ range $name, $taxonomy := .Site.Taxonomies.categories }}
                        <a href="{{ "/categories/" | relLangURL }}{{ $name | urlize }}" class="flex justify-between items-center text-sm font-bold text-gray-600 hover:text-red-600 transition border-b border-gray-100 pb-2">
                            <span class="uppercase">{{ $name | humanize }}</span>
                            <span class="bg-gray-100 text-gray-500 text-[10px] px-2 py-0.5 rounded-full">{{ $taxonomy.Count }}</span>
                        </a>
                        {{ end }}
                    </div>
                </div>

            </div>
        </aside>

    </div>
</div>
{{ end }}
